from sklearn.datasets import fetch_20newsgroups
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import GridSearchCV

# Load dataset (simulate spam filter)
data = fetch_20newsgroups(subset='train', categories=['rec.autos', 'sci.space'])
X = TfidfVectorizer(stop_words='english').fit_transform(data.data)
y = data.target

# Logistic Regression with regularization tuning
params = {"C": [0.01, 0.1, 1, 10], "penalty": ["l2"]}
grid = GridSearchCV(LogisticRegression(max_iter=1000), params, cv=3)
grid.fit(X, y)

print("Best Params:", grid.best_params_)
print("Best Score:", grid.best_score_)
